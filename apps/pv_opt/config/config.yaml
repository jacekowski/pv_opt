# Internal configuration --- DO NOT EDIT ---
pvpy:
  module: pvpy
  global: true

sunsynk:
  module: sunsynk
  global: true

inverters:
  module: inverters
  global: true

pv_opt:
  module: pv_opt
  class: PVOpt
  dependencies:
    - pvpy
    - sunsynk

  log: pv_opt_log
  prefix: pvopt
  manual_tz: Europe/London
  #debug: True


# User configuration ---  EDIT AWAY! ---
  inverter_type: "SUNSYNK_HA"
  # inverter_type: "SOLIS_CORE_MODBUS"
  # inverter_type: SOLIS_SOLARMAN
  device_name: sunsynk

  # If true the current config in HA will be over-written with that in the config.yaml. 
  overwrite_ha_on_restart: false

  # If true the personal data will be redacted from the log files. 
  # redact_personal_data_from_log: false

  # ========================================
  # Basic parameters
  # ========================================
  read_only: false # If true the inverter will not be controlled
  forced_discharge: true # Enable forced discharging
  allow_cyclic: true # Enable alternate charge/discharge windows

  # ========================================
  # Plant parameters
  # ========================================

  # All parameters can be a number or point to an entity UNLESS they start with 'id_'. All of
  # these are required but will be defaulted if not specified

  battery_capacity_wh: 14400
  inverter_efficiency_percent: 95 # Default: 97
  charger_efficiency_percent: 91 # Default: 91
  maximum_dod_percent: 10
  charger_power_watts: 4000
  inverter_power_watts: 4000
  inverter_loss_watts: 50
  
  # ========================================
  # Solcast configuration
  # ========================================
  use_solar: true
  #
  id_solcast_today: sensor.solcast_pv_forecast_forecast_today
  id_solcast_tomorrow: sensor.solcast_pv_forecast_forecast_tomorrow
  solar_confidence_level: 50
  
  # ========================================
  # Consumption forecast parameters
  # ========================================
  #
  # use_consumption_history: true
  # consumption_history_days: 2
  #
  daily_consumption_kwh: 30
  shape_consumption_profile: false

  # ========================================
  # Octopus account parameters
  # ========================================

  octopus_auto: True # Read tariffs from the Octopus Energy integration. If successful this over-rides the following parameters

  # octopus_account: !secret octopus_account
  # octopus_api_key: !secret octopus_api_key

  # The following Can be omitted if either of the above options is working correctly:

  # octopus_import_tariff_code: E-2R-VAR-22-11-01-G
  # octopus_export_tariff_code: E-1R-AGILE-OUTGOING-19-05-13-G

  # octopus_import_tariff_code: E-1R-AGILE-23-12-06-L
  # octopus_export_tariff_code: E-1R-OUTGOING-LITE-FIX-12M-23-09-12-G
  # octopus_export_tariff_code: E-1R-OUTGOING-FIX-12M-19-05-13-L

  # octopus_import_tariff_code: E-1R-FLUX-IMPORT-23-02-14-G
  # octopus_export_tariff_code: E-1R-FLUX-EXPORT-23-02-14-G
  

  id_consumption_today: sensor.{device_name}_day_load_energy
#  id_consumption_today: sensor.{device_name}_day_grid_import
  id_grid_import_today: sensor.{device_name}_day_grid_import
  id_grid_export_today: sensor.{device_name}_day_grid_export

# Tariff comparison
  id_daily_solar: sensor.{device_name}_day_pv_energy
  alt_tariffs:
    #- name: Agile_Fix
    #  octopus_import_tariff_code: E-1R-AGILE-23-12-06-G
    #  octopus_export_tariff_code: E-1R-OUTGOING-FIX-12M-19-05-13-G

    # - name: Eco7_Agile
    #   octopus_import_tariff_code: E-2R-VAR-22-11-01-G
    #   octopus_export_tariff_code: E-1R-AGILE-OUTGOING-19-05-13-G

    #- name: Eco7_Fix
    #  octopus_import_tariff_code: E-2R-VAR-22-11-01-G
    #  octopus_export_tariff_code: E-1R-OUTGOING-FIX-12M-19-05-13-G
    #- name: Flux
    #  octopus_import_tariff_code: E-1R-FLUX-IMPORT-23-02-14-G
    #  octopus_export_tariff_code: E-1R-FLUX-EXPORT-23-02-14-G